---
title: "中国营商环境的地区差异、时空演变、收敛性与空间集聚性研究"
subtitle: "Working in Progress"
author: "张沐"
date: '`r paste(emo::ji("poo"),"最近修改日期：",lubridate::now())`'
output:
  prettydoc::html_pretty:
    theme: cyanman
    highlight: github
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)

knitr::opts_chunk$set(
  fig.width=9, fig.height=5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  fig.show = TRUE,
  hiline = TRUE
)

setwd("/Users/null/Desktop/Doing Business/prettydoc")
load("index.rda")
load("final_index.rda")
library(ggridges)
library(patchwork)
```



## 摘要
研究目标：。研究方法：。研究发现：。研究创新：。研究价值：。

**关键词：营商环境指标体系、Dagum基尼系数、自适应核密度估计、边际垂直$\beta$收敛、Moran’s I指数**


## 引言

## 一、营商环境的内涵及指标体系构建方法

### 1.“十四五规划”下营商环境的内涵

这一部分使用PCA方法进行测度，首先对每个一级指标下的诸多指标进行整合，得到五个子系统的得分情况，然后再用同样的方法对五个子系统再做一次PCA，得到最终的营商环境指标。


### 2.数据来源与处理

### 3.营商环境指标体系的构建



## 二、营商环境的实证分析方法

### 1.营商环境的区域差异分析

在衡量地区差异中总常用的统计指标是基尼系数，而随着统计学的发展，在传统基尼系数的基础之上逐渐又演化出泰尔指数（1967）、Pyatt基尼系数（1967）和Dagum基尼系数（1997）等一系列不平等的统计方法。传统基尼系数只能比较各个地区的整体不平等程度，不能近一步揭示不平等的来源和特征，并且在研究对象是空间非均衡时得到结果的准确性往往会受到质疑。泰尔指数虽然在传统基尼系数的基础之上将区域间的总体差异近一步分解为组内差异和组间差异两部分，但是要求不同组别的样本应满足独立同方差和正态分布，而在实际中这一点往往难以满足。Pyatt基尼系数则将基尼系数近一步分解为三个部分：区域内差异、区域间差异和层迭项（overlapped），但是由于计算过程的繁杂因而其主要贡献体现在理论证明上。而Dagum基尼系数则在上述方法的基础之上，不仅可以有效克服基尼系数不能按子群进行分组测算的局限，同时还能定量得到不同子群对地区差距的各自贡献程度以及解决样本交叉重叠的问题（插入一大堆文献）。因此，本文依照Dagum基尼系数的计算方法将营商环境指标差异分解为区域内差异（$G_w$）、区域间差异（$G_{nb}$）和超变密度（$G_{t}$）的贡献三部分，并将全国除港澳台和西藏外的30个省市划分为东、中、西三大区域。整体基尼系数的计算公式如式（1）所示：

\begin{equation}
G=\sum_{j=1}^{k} \sum_{h=1}^{k} \sum_{i=1}^{n_{j}} \sum_{r=1}^{n_{h}}\left|y_{j i}-y_{h r}\right| /\left(2 n^{2} \bar{y}\right)  \tag{1}
\end{equation}

其中，$G$表示整体基尼系数，数值越大表示总体的差异越大；$k$为区域划分个数，在本文中$k$为3；$n$为省市总个数，在本文中$n$为30；而$n_j（n_h）$为第$j（h）$个区域内部的省市个数；$y_{ji}（y_{hr}）$为第$j（h）$个区域内部营商环境指标；$\bar{y}$为全国营商环境指标的均值。

而在进行Dagum基尼系数分解前，需要按照式（2）的方式对各个区域营商环境指标的平均值进行由小到大的排序。

\begin{equation}
\bar{y}_{1} \leqslant \bar{y}_{2} \leqslant \cdots \leqslant \bar{y}_{j} \leqslant \cdots \leqslant \bar{y}_{k} \tag{2}
\end{equation}

\begin{equation}
G_{j j}=\frac{\sum_{i=1}^{n_{j}} \sum_{r=1}^{n_{j}}\left|y_{j i}-y_{j r}\right| /\left(2 \bar{y}_{j}\right)}{n_{j}^{2}} \tag{3}
\end{equation}

\begin{equation}
G_{j h}=\frac{\sum_{i=1}^{n_{j}} \sum_{r=1}^{n_{h}}\left|y_{j i}-y_{h r}\right|}{n_{j} \cdot n_{h} \cdot\left(\bar{y}_{j}+\bar{y}_{h}\right)} \tag{4}
\end{equation}

式（3）和式（4）分别表示第$j$个区域的基尼系数$G_{jj}$和第$j$个区域与第$h$个区域的区域间基尼系数。式中的$\bar{y_j}$和$\bar{y_h}$分别表示第$j$个区域与第$h$个区域的营商环境指标均值；${n_j}$和${n_h}$则分别表示第$j$个区域与第$h$个区域的省市数量。近一步，将总体基尼系数分解为区域内基尼系数、区域间基尼系数和超变密度，如式（5）所示：

\begin{equation}
G = G_{w}+G_{nb}+G_{t} \tag{5}
\end{equation}

式（6）至式（8）分别给出了区域内基尼系数、区域间基尼系数和超变密度的计算公式：

\begin{equation}
G_{w}=\sum_{j=1}^{k} G_{j j} \cdot p_{j} \cdot s_{j} \tag{6}
\end{equation}

\begin{equation}
G_{n b}=\sum_{j=2}^{k} \sum_{h=1}^{j-1} G_{j h}\left(p_{j} s_{h}+p_{h} s_{j}\right) D_{j h} \tag{7}
\end{equation}

\begin{equation}
G_{t}=\sum_{j=2}^{k} \sum_{h=1}^{j-1} G_{j h}\left(p_{j} s_{h}+p_{h} s_{j}\right)\left(1-D_{j h}\right) \tag{8}
\end{equation}

其中，$p_i = n_j/n$，$s_j = (n_j \cdot \bar{y_i})/(n \cdot \bar{y})$。并且，$\sum p_j = \sum s_j = \sum_{j = 1}^{k}\sum_{h = 1}^{k}p_js_h = 1$。$D_{jh}$表示第$j、h$个区域间的营商环境指标的相对影响，计算公式如式（9）所示：

\begin{equation}
D_{j h}=\left(d_{j h}-p_{j h}\right) /\left(d_{j h}+p_{j h}\right) \tag{9}
\end{equation}

在式（9）中，$d_{j h}$和$p_{j h}$分别表示$j、h$区域中所有$y_{ji} \succ y_{hr}$的样本值之和的数学期望和$j、h$区域中所有$y_{ji} \prec y_{hr}$的样本值之和的数学期望，两者的具体计算公式如式（10）和式（11）所示。其中，$F_j$和$F_h$分别表示$j、h$区域的累积分布函数。

\begin{equation}
d_{j h}=\int_{0}^{\infty}dF_{j}(y) \int_{0}^{y}(y-x)dF_{h}(x) \tag{10}
\end{equation}


\begin{equation}
p_{j h}=\int_{0}^{\infty}dF_{h}(y) \int_{0}^{y}(y-x)dF_{j}(x) \tag{11}
\end{equation}



### 2.营商环境的动态分布演进分析

虽然Dagum基尼系数可通过对营商环境指标的区域差异进行分解而得到描述差异特征和来源的具体数值，但是并不能对营商环境指标的分布曲线进行可视化分析，为了近一步研究中国营商环境指标分布形态和动态演进特征，本文近一步使用核密度估计曲线（KDE）来展开实证研究。目前，对于区域指标的动态分布演进的实证方法主要为马尔科夫链法和核密度估计法。其中，马尔科夫链法的使用往往要满足两个前提假定。第一，一阶马尔科夫链（First-order Markov Chain），即指标未来的演变状态仅受当前状态的影响，而不受过去历史的影响；第二，时间同质性（Time Homogeneity），即在样本考察期内，马尔科夫转移矩阵是时不变的。而核密度估计法则并不需要对分布的形式作出事先假定，而是基于数据的自身信息使用连续密度曲线对随机变量的概率密度进行估计。因此，核密度估计具有较弱的模型依赖性，最终得到的估计结果具有较强的稳健性。假设$f(x)$为中国营商环境指标$x$的密度函数，则有：

\begin{equation}
f(x)=\frac{1}{N h} \sum_{i=1}^{N} K\left(\frac{X_{i}-x}{h}\right) \tag{12}
\end{equation}

其中，$N$为观测值个数，$X_i$表示独立同分布的观测值，$x$则表示观测值的均值，$K(\cdot)$表示核密度函数，$h$为带宽。由于核密度的估计对带宽的选择相当敏感，因此带宽选择的合适与否便直接影响到最后估计结果的精确性。具体来说，在数据和核函数不变时，带宽的上升会导致估计的方差下降，曲线更加平滑，但估计的偏差却会上升，反之则反。对于带宽的选择，常见的方式是Sliverman的拇指法则（1986）和交叉验证法，但是这两种方法所得的最优带宽为为常数，而在密度并不接近正态时，则可能会产生泛化极差的估计。此外，Burkhauser（1999）指出尾端观测值的信息往往要少于中间的观测值，所以在数据较为稀疏的区域选择固定带宽会过度的平滑，整体的密度形状将会扭曲。为解决上述问题，本文使用自适应带宽核密度法（Adaptive Bandwidth Kernel Density Method），其基本思想是先对密度进行逐点估计，得到一组针对个体观测值的局部带宽系数，然后基于这组数据构建自适应带宽，从而实现了带宽随着样本的位置而变化。也即自适应带宽核密度法是基于固定带宽核密度函数的基础上，通过修正带宽参数而得到的，其具体数学表达式如式（12）所示：

\begin{equation}
f(x)=\frac{1}{N} \sum_{i=1}^{N} \frac{ w_{i}}{\lambda_{i}h_{N}} K\left(\frac{X_{i}-x}{\lambda_{i}h_{N} }\right) \tag{13}
\end{equation}

其中，$w_i$为抽样权重；$h_N$为固定带宽法下计算得到的带宽；$\lambda_i$为带宽调整因子（Bandwidth Adjustment Factors）；$\lambda_i$和$h_N$的乘积构成了局部带宽。

自适应核密度估计过程通常分为两个阶段。第一阶段，基于固定带宽法先进行一次先导密度估计（Pilot Density Estimate）；第二阶段，基于上一步的结果，由式（13）计算出带宽调整因子。

\begin{equation}
\lambda_{i}=\left[\frac{e^{\frac{\sum_{j=1}^{N} w_{j}log f(x_i)}{N}}}{f(x_i)}\right]^{\alpha}  \tag{14}
\end{equation}
其中，$\alpha$称为敏感性系数，在0~1内进行取值，不难发现当$\alpha$取为0时，自适应核密度估计便退化为常数带宽的核密度估计。根据Abramson（1982）提出的平方根定律（Square Root Law），当$\alpha$为0.5时，自适应核密度估计比普通核密度估计有更小的估计偏误。

在进行核密度估计时，往往需要确定核函数，而核函数根据其表达形式的差别可分为高斯核、三角核、四角核以及Epanechnikov核等，本文使用较为常用的高斯核密度函数对全国整体和三大区域营商环境指标的动态分布演变进行估计。最终，高斯核的自适应核密度函数为：

\begin{equation}
f(x) = \frac{1}{\sqrt{2\pi}Nh_N}\sum_{i = 1}^{N}\frac{e^{-\frac{1}{2}(\frac{X_i}{\lambda_ih_N})^2}}{\lambda_i} \tag{15}
\end{equation}



### 3.营商环境的收敛性分析

对于经济指标收敛性的研究根据其研究视角的不同，可分为时间视角和空间视角两类，分别对应时间收敛和空间收敛。不难理解，时间收敛是指随着时间的推移，初始存在差距的两个个体间的差距会逐渐缩小；而空间收敛则是指处于外围空间的个体，其经济指标具有趋向于中心个体的特征。（刘明，王思文 2018）。对于时间收敛，常见的模型有$\sigma$收敛模型、绝对$\beta$收敛模型、条件$\beta$收敛模型和俱乐部收敛模型。而对于对于空间收敛的分析，常见的模型有加入空间矩阵的拓展$\beta$收敛模型：空间误差模型（SEM）、空间杜宾模型（SBM）等。本文对于营商环境指标收敛性研究中重点关注其时间收敛性，因此使用基本的$\sigma$收敛模型和基于$\beta$收敛模型的拓展模型——边际垂直$\beta$收敛（Marginal Vertical $\beta$-convergence ）模型。


#### （1）$\sigma$收敛模型

$\sigma$收敛是指随着时间的推移不同地区的营商环境指标偏离整体平均的差异呈现出逐渐减小的趋势，其常见的测度指标有变异系数、基尼系数和泰尔指数等。参照大多数文献的做法，本文使用变异系数来测度营商环境指标均等化的$\sigma$收敛，其具体计算公式如下所示：

\begin{equation}
\sigma_{t}=\frac{\sqrt{\frac{1}{n} \sum_{i=1}^{n}\left(Index_{i t}-\frac{1}{n} \sum_{i=1}^{n} Index_{i t}\right)^{2}}} { \frac{1}{n} \sum_{i=1}^{n} Index_{i t}} \tag{16}
\end{equation}

其中，$Index_{it}$为$t$年第$i$个省市的营商环境得分。若$\sigma_t$随时间的推移而减小，则说明各省市的营商环境指标差距在不断减小，具有向均值收敛的趋势。


#### （2）边际垂直$\beta$收敛模型

边际垂直$\beta$收敛模型是基于传统$\beta$收敛模型，以全样本下的$\beta$系数（传统$\beta$收敛模型的估计结果）和子样本下$\beta$系数的差值作为捕捉每个个体在收敛或发散过程中起到的边际贡献，并依照个体的异质性以找出影响经济指标收敛或发散的影响因素。因此，有必要先介绍传统的$\beta$收敛模型。在仅考察一期的情况下，传统的$\beta$收敛模型可表示为：

\begin{equation}
log \left(\frac{y_{i,t+1}}{y_{i t}}\right)= \alpha_0+\alpha_1 log \left(y_{i t}\right)+\lambda_i+\eta_t+\mu_{it} \tag{17}
\end{equation}

其中，$\alpha_0$为常数项；$(e^{-\beta}-1)$为重点关注系数，若其显著为负则说明营商环境指标存在$\beta$收敛性质，反之则说明发散；$\lambda_i$和$\eta_t$分别表示个体（省市）固定效应和时间固定效应；$\mu_{it}$表示误差项。近一步，$\beta$收敛模型中的$\beta$系数和$\alpha_1$的数学关系为：

\begin{equation}
\alpha_1 = -(1-e^{-\beta}) \tag{18}
\end{equation}


不难发现，当$\beta$为正且数值越大时，$\alpha_1$为负且绝对值也越大。两者的相关关系如下图所示。

```{r echo=FALSE}
library(latex2exp)
tibble(
  x = seq(-1,1,by = 0.01)
) %>% 
  mutate(
    y = exp(-x)-1
  ) %>% ggplot(aes(x,y))+geom_point(color = "grey")+geom_line()+
  geom_hline(yintercept = 0,linetype = "solid",color = "black",size = 1)+
  geom_vline(xintercept = 0,linetype = "solid",color = "black",size = 1)+
  # ggrepel::geom_label_repel(aes(x = -0.5))+
  labs(x = TeX("$\\beta$"),y = TeX("$\\alpha_1$"))+
  theme(text = element_text(family = cnfont),
        axis.line.y = element_blank(),axis.line.x = element_blank())
```


除此之外，在$\beta$收敛分析中，半期收敛系数（Half-life of Convergence Coefficient）也比较常用，其计算方法如下式所示：

\begin{equation}
T_{\frac{1}{2}} = \frac{log2}{\beta} \tag{19}
\end{equation}

半期收敛系数的经济学意义为：各地区经济指标的差异缩小为初始差异一半时所经历的时间（Izabela 2016），其基本作用是以当下的收敛速度，预测达到稳态均衡时所需要的时间。

根据Batóg（2021）的做法，边际垂直$\beta$收敛模型的估计步骤分为两步。第一步，对式（16）进行估计，得到$\hat\alpha_1$，然后由$\hat\alpha_1$求得$\hat\beta$；第二步，将第$i$个地区从样本中删去，重复第一步，得到$\hat \beta_{i}^{n-1}$，再将两次得到的结果相减便得到了$i$地区的边际垂直收敛速度$\Delta\beta_i$，$\Delta\beta_i$的数学表达式为：


\begin{equation}
\Delta\beta_i = \hat\beta - \hat\beta_{i}^{n-1} \tag{20}
\end{equation}

其中，$\hat\beta$为整体收敛速度（General Convergence Speed）；$\hat\beta_{i}^{n-1}$为除去$i$地区后的收敛速度；两者之差$\Delta\beta_i$表示$i$地区的边际垂直收敛速度，也即$i$地区在收敛过程中的边际贡献，当其为正数时，说明$i$地区在整体的收敛过程中起到了正向的推动作用，且数值越大这种边际贡献也就越大。对于半期收敛系数，其计算方式类似：

\begin{equation}
\Delta T_{\frac{1}{2},i} = \hat T_{\frac{1}{2}}-\hat T^{n-1}_{\frac{1}{2},i} \tag{21}
\end{equation}

假定$\Delta T_{\frac{1}{2},i}$为负且绝对值为$t_0$时，对此的解释为：由于$i$区域的影响，导致差异缩小为初始差异一般时所需要的时间减少了$t_0$年。







### 4.营商环境的地区空间集聚性分析

这一部分使用Moran’s I指数来进行分析


## 三、基本事实特征：营商环境测度结果

### 1.营商环境指标子系统发展趋势

近一步，为了更加详细展示5个子系统在不同区域和不同时间的变化情况，本文采取了分面图的形式进行说明。


```{r echo=FALSE}
load("final_index.rda")
load("index.rda")

##########################################################################
# 1 准备数据

## 1.1 准备index_tweak
map_dbl(index[4:8],~min(.x)) %>% sort(decreasing = F) %>% .[[1]] -> min 
map_dbl(index[4:8],~max(.x)) %>% sort(decreasing = F) %>% .[[1]] -> max

index %>% 
  mutate(
    across(
      4:8,
      ~ (.x-min)/(max-min)
    )
  ) -> index_tweak

rm(min,max)

## 1.2 准备 final_index_tweak

final_index %>% 
  mutate(index = (index-min(index))/(max(index)-min(index))) -> final_index_tweak


## fig1：定子系统，重点对比不同地区随时间变化的情况
index_tweak %>% 
  group_by(year,location) %>% 
  summarise(
    across(
      where(is.numeric),mean
    )
  ) %>% ungroup() %>% 
  pivot_longer(-c(1:2),names_to = "子系统类别",values_to = "子系统得分") %>%
  ggplot(aes(year,子系统得分,color = location))+
  geom_line(size = 1)+
  geom_point(aes(shape = location),show.legend = F,size = 2.5)+
  facet_wrap(.~子系统类别,scales = "free")+
  # scale_color_manual(values = c("black","blue","green"))+
  scale_color_viridis_d()+
  scale_x_continuous(n.breaks = 6)+
  labs(color = "地区",x = "年份")+
  theme(
    legend.position = "bottom",text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20))
```

由上图可以看出，对于“开放化水平”、“企业法治环境”和“企业经营环境”这三个子系统，
三大区域都是呈现一个随时间递增的趋势。其中，东部地区在这三个子系统方面始终领先于另外两个区域。对于中部地区和西部地区而言，在“开放化水平”子系统下，西部地区要高于中部地区，而在“企业法治环境”中则恰恰相反，在“企业经营环境”中，两个地区则比较接近。对于“政府对企业的保护”和“政府公共服务水平”而言，三大区域的随时间变化趋势较为平稳。与之前雷达图所反映的信息一样，西部地区在这“政府对企业的保护”子系统下的得分始终高于其余两个地区，而在“政府公共服务水平”中，期初中部地区和东部地区的差异不大，但在2017年时，东部地区的得分高于中部地区，而且两者之间的差距随时间不断扩大。

```{r echo=F}
## fig2：定地区，看子系统随时间的得分情况

index_tweak %>% 
  group_by(year,location) %>% 
  summarise(
    across(
      where(is.numeric),mean
    )
  ) %>% ungroup() %>% 
  pivot_longer(-c(1:2),names_to = "子系统类别",values_to = "子系统得分") %>%
  ggplot(aes(year,子系统得分,color = 子系统类别))+
  geom_line(size = 1)+
  geom_point(aes(shape = 子系统类别),show.legend = F,size = 2.5)+
  facet_wrap(.~location,scales = "free")+
  scale_x_continuous(n.breaks = 6)+
  labs(color = "子系统",x = "年份")+
  # scale_color_manual(values = c("black","blue","green","red","yellow"))+
  scale_color_viridis_d()+
  theme(
    legend.position = "bottom",text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20))

```

在上图中，三大区域的5个子系统随时间变化的趋势各不相同。首先，从5个子系统的相对变化趋势而言。对于东部地区，5个子系统的得分趋近于发散；对于中部地区，得分基本保持平稳，但是存在收敛的趋势；对于西部地区而言，收敛趋势十分明显。

其次，具体而言，对于东部地区。“企业法治环境”子系统得分变化最大，“开放化水平”次之，再次“企业经营环境”，最后是“政府公共服务水平”，而“政府对企业的保护”得分相对稳定；对于中部地区而言，除去“政府公共服务水平”和“企业法治环境”在个别年份出现下降之外，其余子系统的得分均呈现出稳定递增的趋势。总体上来说，在2010年至2019年，中部地区五个子系统的得分均有上升；对于西部地区而言，“企业经营环境”和“政府对企业的保护”虽在2015年存在过下降，但是之后保持稳定，其余的三个子系统得分则呈现出不同程度的上升。


### 2.营商环境指标变化趋势

```{r echo=FALSE}
# 营商环境指标整体变化情况

## fig1：全国下的整体和子系统得分对比

final_index_tweak %>% group_by(year) %>%
  summarise(
    across(where(is.numeric),
           list(mean = mean)
    )) %>%
  ungroup() %>% set_names(c("year","均值")) -> df

index_tweak %>% group_by(year) %>%
  summarise(
    across(where(is.numeric),
           list(mean = mean)
    )) %>%
  ungroup() %>% full_join(df,"year") -> df

df %>% pivot_longer(-1) %>% 
  mutate(name = str_remove_all(name,"_mean")) %>% 
  mutate(
    name = factor(
      name,
      levels = c("开放化水平","政府对企业的保护","企业经营环境","企业法治环境","政府公共服务水平","均值"),
      labels = c("开放化水平","政府对企业的保护","企业经营环境","企业法治环境","政府公共服务水平","营商环境整体指标")
    )
  ) %>% dplyr::filter(name != "营商环境整体指标") -> df1


df %>% pivot_longer(-1) %>% 
  mutate(name = str_remove_all(name,"_mean")) %>% 
  mutate(
    name = factor(
      name,
      levels = c("开放化水平","政府对企业的保护","企业经营环境","企业法治环境","政府公共服务水平","均值"),
      labels = c("开放化水平","政府对企业的保护","企业经营环境","企业法治环境","政府公共服务水平","营商环境整体指标")
    )
  )  %>% pivot_wider(names_from = name,values_from = value) %>% 
  select(1,ncol(.)) -> df

ggplot()+
  geom_col(data = df,aes(year,营商环境整体指标),fill = alpha("grey"))+
  geom_line(data = df1,aes(year,value,color = name),size = 1)+
  geom_point(data = df1,
             aes(year,value,shape = name,color = name),
             size = 3,show.legend = F)+
  labs(color = "子系统",x = "年份")+
  # scale_color_manual(
  #   values = c("black","blue","green","red","yellow")
  # )+
  scale_color_viridis_d()+
  scale_shape_manual(
    values = c(1,15:18)
  )+
  scale_x_continuous(n.breaks = 10)+
  theme(
    legend.position = "bottom",text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20)
  )
```


从上图可以看出，在全国范围内，营商环境指标的均值从期初的???变为期末的???，增幅高达???，说明在这10年间，我国营商环境的整体水平有极大的提高。

<span style='color:red'>还有一段话要加上去，具体对5个子维度进行细说。</span>



```{r echo=F}
## fig2：全国营商环境和三大地区的得分情况对比

final_index_tweak %>% 
  group_by(location,year) %>% 
  summarise(index = mean(index)) %>% 
  pivot_wider(names_from = location,values_from = index) %>% 
  mutate(
    全国 = (东部地区+中部地区+西部地区)/3
  ) %>% 
  pivot_longer(-1,names_to = "location",values_to = "index") %>% 
  ggplot(aes(year,index,color = location))+
  geom_line(size = 1)+
  labs(x = "年份",y = "得分",color = "地区")+
  scale_x_continuous(n.breaks = 10)+
  geom_point(aes(shape = location),show.legend = F,size = 3) +
  scale_color_viridis_d()+
  # scale_color_manual(values = c("black","blue","green","red"))+
  scale_shape_manual(values = c(15:18))+
  theme(
    legend.position = "bottom",text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20)
  )

```

从上图中可以看出，无论是全国范围内还是三大区域，营商环境指标均呈现出随时间稳定增长的趋势。

<span style='color:red'>具体对5个子维度进行细说，结合统计数据说增幅情况。</span>



```{r echo=FALSE}
load("final_index.rda")
load("raw.rda")
pacman::p_load(lubridate,sf,geojsonsf,geojsonio,jsonlite,haven)


final_index %>%  
  mutate(index = (index -min(index))/(max(index)-min(index))) %>% 
  mutate(new = round(index,3)) -> final_index

prov_unify <- function(df,province=province) {
  df %>% pull({{province}}) -> target
  if_else(str_detect(target,"[内蒙古黑龙]"),
          str_replace_all(target,"(.{3}).*","\\1"),
          str_replace_all(target,"(.{2}).*","\\1")) -> target
  df %>% bind_cols(target) %>% rename("new" = ncol(.)) %>%
    relocate(ncol(.),.after = {{province}}) %>% select(-{{province}}) %>%
    rename("province" = "new")
} # end of "cn_province"

raw %>% prov_unify(省) %>% 
  sf_geojson() %>% 
  fromJSON(simplifyVector = FALSE) -> provmap

final_index %>% dplyr::filter(year == 2019) %>% pull(4) %>% quantile() -> qqq

highchart() %>% # 使用JavaScript方式
  hc_chart(
    type = "map", # 指定何种geoms
    spacingBottom = 10,
    spacingTop = 10,
    spacingLeft = 10,
    spacingRight = 10,
    style = list(
      fontFamily = cnfont
    )
  ) %>% 
  hc_add_series_map(map = provmap,
                    df = final_index %>% dplyr::filter(year == 2019), 
                    joinBy = c("province", "province"), 
                    value = "index", 
                    name = "营商环境指标：",
                    borderWidth = 1,
                    borderColor = "white",
                    states = list(hover = list(color = '#bada55')),
                    dataLabels = list(enabled = FALSE)) %>% 
  hc_add_series(
    data = provmap,
    type = "mapline",geojson = T,
    color = "black",borderWidth = 0.5,show.legend = T
  ) %>% 
  hc_colorAxis(dataClasses = list(
    list(to = qqq[[1]], color = alpha("grey",0.2), name = "数据缺失"),
    list(from = qqq[[1]], to = qqq[[2]], color = alpha("grey",0.4)),
    list(from = qqq[[2]], to = qqq[[3]], color = alpha("grey",0.8)),
    list(from = qqq[[3]], to = 1.2, color = "grey"))) %>% 
  hc_tooltip(headerFormat = "",
        pointFormat = "<b>{point.province}</b><br>营商环境指标：{point.new}",
             borderRadius = 5) %>% 
  hc_legend(align = 'center',
            # layout = 'horizontial',
            verticalAlign = "bottom",
            itemMarginTop= 3,
            itemMarginBottom= 3,
            valueDecimals = 3,
            # floating = TRUE,
            symbolRadius = 0,
            # x = 200, y = -20,
            symbolHeight = 14, 
            title = list(text = " ")) %>% 
  hc_title(
    text = str_c(2019,"年全国各地营商环境指标分布情况")
  )
```




```{r  echo=FALSE}
group_sort <- function(df,group_var,id_var,target_var) {
  group_var <- enquo(group_var)
  id_var <- enquo(id_var)
  target_var <- enquo(target_var)
  
  map_df(
    df %>% count(!!group_var) %>% pull(1) %>% rev(),
    ~ df %>% dplyr::filter(!!group_var == .x) %>% arrange(!!target_var)
  ) %>%
    mutate(!!id_var := fct_inorder(!!id_var,ordered = T))
} # end of "group_sort"

library(ggchicklet)
load("final_index.rda")
final_index %<>% mutate(index = (index-min(index))/(max(index)-min(index)))

final_index %>% 
  dplyr::filter(year == 2019) %>% 
  group_sort(location,province,index) %>% 
  ggplot(aes(province,index,fill = location))+
  geom_chicklet(radius = unit(2,"pt"),
                color = alpha("white",0.5))+
  coord_flip()+
  # geom_hline(yintercept = qqq[[2]],linetype = "dashed",color = "black")+
  # geom_hline(yintercept = qqq[[3]],linetype = "dashed",color = "black")+
  # geom_hline(yintercept = qqq[[4]],linetype = "dashed",color = "black")+
  labs(x = "",y = "得分",fill = "地区")+
  scale_fill_manual(values = c(alpha("black",0.2),"darkgrey",alpha("black",0.6)))+
  # scale_color_viridis_d()+
  scale_y_continuous(limits = c(0,1.25))+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20),
    legend.position = "bottom",
    axis.text.y.left = element_text(size = 8)
  )

```


分层情况相当明显。在2019年，对于东部地区而言，没有一个省市其营商环境指标小于0；而对于中部地区，河南省和吉林省营商环境指标小于0；对于西部地区，除了重庆、四川和广西三地外，其余省市的指标均小于0。


## 四、营商环境区域差异及其来源

```{r echo=FALSE}
load("gini.rda")

gini %>% set_names(c("年份","全国","东部地区","中部地区","西部地区","东-中","东-西","中-西","Gw","Gnb","Gt")) %>% 
  knitr::kable(digits = 2)
```


### 1.全国整体差异

```{r echo=FALSE}
load("gini.rda")

##########################################################################

# 地区内的gini

gini %>% select(1:5) %>% 
  pivot_longer(-1,names_to = "地区") %>% 
  mutate(
    地区 = factor(
      地区,
      levels = c("g","东部地区","中部地区","西部地区"),
      labels = c("全国","东部地区","中部地区","西部地区")
    )
  ) %>% 
  ggplot(aes(year,value,color = 地区))+
  geom_line(size = 0.8)+
  scale_colour_ggthemr_d()+
  scale_color_viridis_d()+
  labs(y="区域内基尼系数",x = "年份")+
  geom_point(aes(shape = 地区),size = 3)+
  scale_x_continuous(n.breaks = 10)+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20),
    legend.position = "bottom"
  )
```

为了直观展示全国总体和三大区域内的差异随时间的演变趋势，本文基于上表的数据做出上图所示的折线图。其中，横轴代表年份，纵轴为对应年份和地区的区域内基尼系数。对于全国层面而言，整体基尼系数的均值为0.23，并在0.204~0.266的范围内波动，说明中国整体层面上的营商环境指标存在的一定地区差异性，但就数值的绝对大小而言，整体差异的程度比较低。其次，整体基尼系数随时间的变化趋势呈现出一个“减小-增加”的结构，在2010年至2015年不断下降，而在之后的年份则增加，并且增长的速度在2019年有所放缓。再次，结合具体数值，在下降期内，全国整体基尼系数由期初2010年的0.266下降至2015年最低点的0.204，降幅为30.39%，年平均减速为1.24%；而在上升期内，虽整体基尼系数呈现上升的趋势，但年平均增速为0.88%，明显要低于整体基尼系数的下降速度。并且在2018年至2019年，基尼系数的增幅仅为0.57%，也即这种差距被拉大的速度明显正在降低。纵观整个考察期，整体基尼系数呈下降趋势且降幅近似为10%。综合以上信息，说明虽然各地经济发展水平、地理位置以及政府政策上存在的差别导致各地的营商环境之间存在一定的差距，但当营商环境的重要性日益凸显，各地政府在进行优化改善时的重视程度和执行力度均在不断提高时，这种差距正在不断的缩小，从而导致整体的非均衡状态呈现出减小的态势。


### 2.区域内差异


上图还汇报了三大区域的区域内基尼系数随时间的演变趋势。就三条线的相对位置来说。在2012年之前，西部地区的区域内差异最大，而2013年时与东部地区一致，随后始终处于东部地区区域内基尼系数线之下。因此，在三大区域中，区域内差异最大的东部地区、其次为西部地区，最小的为中部地区。

对于东部地区来说，其演变趋势可描述为“下降-稳定-上升”。其中，2010年至2013年对应下降期，2014年至2016年对应稳定期，而2016年至2019年对应上升期。具体而言，在下降期内东部地区的区域内基尼系数由0.228下降到0.196，降幅为15.94%。而随后一年内区域内基尼系数有所回升。在2014年至2016年，东部的区域内基尼系数较为稳定，基本在0.2的上下小幅波动。而在2016年之后，基尼系数开始以年平均0.78%的速度持续上升。纵观整个考察期，东部地区的地区内差异经历了一个较为平稳的先下降再上升的过程，这10年内的差距增幅不过0.09%，故认为东部地区内部的差异较为稳定。

对于中部地区来说，其演变趋势为“下降-上升”。结合具体数据，在2010年至2015年的下降期内，区域内基尼系数降幅为13.1%。而从2015年至2019年的上升期又可以分为两个不同增速的区间。其中，2015年至2017年为快速增长区，年平均增速为1.13%。在2017年之后，增速明显放缓，年平均增速为0.54%。也即中部地区的区域内基尼系数曾经历过一段平缓的下降期，而在2015年之后转而上升，并且增速在期末又有所放缓，说明中部地区的区域内差异正在不断拉大，但是这种变化的速度正慢慢减小。

对于西部地区来说，整体上呈现出一个“下降-上升-下降”的形状。在2010年至2015年，经历了一个快速的下降期，由期初2010年的0.292骤减到期中2015年的0.162，降幅为80.27%，年平均减速为2.6%。在随后的三年内，随在2017年出现过小幅的下降，但整体上为上升趋势，年平均增速为1.09%。整体上来说，西部地区的区域内基尼系数呈现出下降趋势，且在观测期内的标准差为0.044，下降幅度为三个地区中最大。虽在2015年至2018年出现过回升，但是上升的速度不及下降速度的一半，并且在2019年又出现了骤减。所以，在考察期内西部地区的地区内差异是呈现不断缩小的趋势。


### 3.区域间差异


```{r echo=FALSE}
##########################################################################
# 地区间的差异


gini %>% select(1,6:8) %>% 
  pivot_longer(-1,names_to = "地区") %>% 
  ggplot(aes(year,value,color = 地区))+
  geom_line(size = 0.8)+
  labs(y="区域内基尼系数",x = "年份")+
  geom_point(aes(shape = 地区),size = 3)+
  scale_x_continuous(n.breaks = 10)+
  scale_colour_ggthemr_d()+
  scale_color_viridis_d()+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20),
    legend.position = "bottom"
  )
```

第一，综合对比三条线的相对位置。从上图中可以发现，始终处于最上方的是东部地区和西部地区的地区间差异。对于中部地区和西部地区的差异来说，虽在最后两期内要低于东部地区和中部地区间的差异，但整体上来说中西之间的差异依然排在第二位。这说明在三区域间的差异中，“东-西”间的差异最大，其次“中-西”，最次“东-中”。

第二，对于涉及到东部地区的“东-中”和“东-西”两线来说，其变化的趋势基本吻合，均呈现出近似“U”型结构。只是“东-中”线在下降段的2010年至2015年更平坦，而在上升段的2015年至2019年更陡峭。具体而言，在下降期，“东-西”线的极大、极小值分别为0.3767和0.2838，在6年内减幅为32.75%，年平均降低速度为1.55%。而“东-中”线的极大、极小值分别为0.205和0.177，这六年内减幅为15.88%，年平均降低速度为0.47%。而在上升期，对于“东-西”先来说，期末对应的极大值为0.32，并未恢复到期初极大值的0.377，而上升期的年平均速度为0.91%，这说明虽在样本期末“东-西”间的差距有所回升，但对于本文的考察期而言，两地区间的差距呈现缩小态势，且具体减幅为17.61%。对于“东-中”线的上升期，其增长势头明显强于“东-西”线，在期末其极大值0.234，上升期内年平均增速为1.44%，近似为下降期减速的3倍。综合上述信息，可以推断在2010年至2015年下降期内，由于东部地区营商环境改善的速度放缓，从而导致东部地区和另外两区域间的绝对差距在不断缩小，而在2015年转折点之后，东部地区营商环境指标的提升速度显著提高，从而又和另外两地区拉开了差距，而西部地区营商环境指标的提升速度始终要高于中部地区，从而导致两条线弯曲程度的差异。

第三，对于“中-西”线来说，除去在2010年至2011年和2015年至2017年出现的短暂上升外，整体上还是呈现出下降的趋势。而其下降的区间根据减速的不同又可分为2011年至2015年和2017年至2019年这两个下降区。在第一个下降期内，年平均减速为1.78%，而第二个下降期内为0.41%。虽然在2019年中西部地区间的差距并没有回到2015年的历史最低点，但依照“中-西”线所呈现的趋势来看，中部地区和西部地区间的差距将会不断的缩小。

综上所述，本文认为东部地区和另外两地区的差异虽在2010年至2015年有过下降，但之后东部营商环境的改善力度得到加强，从而又拉大了与其他地区的差距，并且根据“东-西”和“东-中”两线的走势来看，这样的差距在未来可能还会持续增加；其次，“中-西”线的情况反映虽然西部地区营商环境的初始禀赋要差于中部地区，但不断下降的走势表明两地之间的差距正在不断的缩小，西部地区营商环境的追赶效应尤为明显。

### 4.区域差异来源及其贡献

```{r echo=FALSE}
gini %>% select(1,9:11) %>% 
  mutate(
    r_gw = gw/(gw+gnb+gt),
    r_gnb =gnb/(gw+gnb+gt),
    r_gt = gt/(gw+gnb+gt),
  ) %>% select(!starts_with("g")) %>% 
  set_names(
    c("year","区域内差异的贡献","区域间净值差异的贡献","超变密度的贡献")) %>% 
  pivot_longer(-1,names_to = "差异来源",values_to = "贡献率") %>% 
  ggplot(aes(year,贡献率,color = 差异来源))+
  geom_line(size = 0.8)+
  scale_colour_ggthemr_d()+
  labs(y="贡献率",x = "年份")+
  geom_point(aes(shape = 差异来源),size = 3)+
  scale_x_continuous(n.breaks = 10)+
  scale_y_continuous(labels = percent)+
  scale_color_viridis_d()+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20),
    legend.position = "bottom"
  )

```


为揭示三大区域营商环境指标的差异来源，依照Dagum基尼系数的分解公式，将整体差异$G$近一步分解为区域内差异$G_w$、区域间差异$G_{nb}$和超变密度$G_t$，具体结果见上表。上图基于上表的结果展示了三类差异对总体差异贡献率随时间的演变趋势。首先，在样本考察期内$G_w$、$G_{nb}$和$G_t$的均值分别为27.59%，55.56%和16.86%，并且三条线的相对位置始终未发生过改变，说明中国营商环境指标总体差异中贡献最大的分别是区域间差异、区域内差异和超变密度。 其次，就曲线的具体形态而言。区域内差异在考察期内相当平稳，最高点和最低点对总体差异的贡献率相差不过2.22%，说明对于单个区域而言，其内部营商环境指标的差异较为稳定。区域间差异曲线则表现为“上升-下降”的趋势，分别在2013年和2018年取到59.19%的最大值和50.31%的最小值。而超变密度的变化趋势则与区域间差异相反，呈现出“下降-上升”的趋势，虽在期末2019年超变密度要高于期初2010年的超变密度，但两者差额仅为2.96%，故认为超变密度虽整体上呈现出上升趋势，但上升幅度并不大。而且依照其趋势来看，超变密度在2018年取到其最大值，在未来可能会呈现出下降的趋势，也即不同区域间交叉重叠的贡献率将会越来越小，这意味着而解决中国营商环境的区域差异问题，得从缩小贡献最大的区域间差异入手，从而实现整体营商环境的协调发展。


## 五、营商环境的动态分布演进特征

Dagum基尼系数基于营商环境相对差异的角度，从三大区域间和区域内的角度展示了营商环境指标分布的空间变化过程。为近一步展示营商环境指标的绝对差异，本节采用自适应核密度估计法，分析核密度估计（KDE）曲线的中心位置、形态、延展性和极化趋势等，对样本考察期内中国营商环境指标的动态分布特征与时变演变趋势进行研究。

### 1.全国整体层面

现有文献多使用三维图或二维多图层叠加的方式来对不同年份的KDE曲线进行可视化展示。对前者来说，依照考察期的年份顺序依次展示对应年份的KDE分布形态，这种方式容易导致考察期期末年份的延展性和极化趋势被前期的KDE曲线遮盖，从而造成信息的损失；对于后者来说，在一个坐标系内使用不同的线型样式或颜色来区分不同的年份，而当考察期年份较多时则会出现曲线重叠问题，不易观测曲线的具体细节。为解决以上两种方法的问题，本文使用山脊图来展示不同年份下不同KDE曲线的形状。

```{r echo=F}
setwd("/Users/null/Desktop/Doing Business/prettydoc")
load("final_index.rda")
library(ggridges)

final_index %>% 
  mutate(index = (index-min(index))/(max(index)-min(index))) -> final_index_tweak

final_index_tweak %>% 
  ggplot(aes(index,factor(year)))+
  geom_density_ridges(rel_min_height = 0.05,alpha = 0.5,
                      color = "darkblue",size = 0.4,
                      scale = 1.5,show.legend = F,
                      quantile_lines = T,quantiles = c(0.025,0.5,0.975),
                      linetype = "dashed")+
  labs(x = "营商环境指标",y = "",title = "全国整体")+
  scale_color_viridis_d()+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20),
    plot.title = element_text(hjust = 0.5)
  )

```

上图表示了全国30个省市在2010年至2019年内营商环境指标的动态分布情况。其中，横轴为营商环境指标得分，纵轴为样本考察期，图形内的三条虚线从左到右依次表示2.5%、50%和97.5%的分位数，用以反映KDE曲线中心位置的延展性的变化。

首先，KDE曲线的中心位置2010年至2015年明显右移，而在2015年至2018年保持稳定，2019年则右移一段距离，取得考察期内的最大值。整体上，KDE曲线呈现出右移趋势，这说明在全国整体层面上，营商环境是逐年稳步提高的。其次，波峰的高度以一定的速度持续下降，同时曲线覆盖的宽度持续增加，这反映出一些省市对营商环境重视度的提高，着手优化当地的企业经营环境，因此其营商环境指标渐渐与其他地区拉开差距。再次，就KDE曲线的分布延展性来说，曲线左侧极值呈现出先减小再增大的规律，而右侧极值则是先增大再稳定，两侧极值之间的距离持续增大，这说明低营商环境指标的省市具有较高的核密度估计值，而高营商环境指标的省市占有的核密度估计值则较少，也即营商环境较为良好的地区依然集中在少部分省市。最后，对于波峰个数的变化，虽在本文的考察期内，全国层面的KDE曲线并未呈现出明显的多峰，但在2017年之后，波峰外凸程度不断下降，且在2019年时，50%分位数的位置已经不再对应波峰最高点，说明全国层面上营商环境的差异正在不断增加。综合以上信息，本文认为以30个省市为代表的全国营商环境指标存在着梯度效应，处于第一梯度的各省其营商环境指标逐年提高，而处于末尾梯队省市的营商环境则基本处于停滞状态，也即两极分化的演变趋势逐渐展现。


### 2.不同区域层面


```{r echo=F}
final_index_tweak %>% 
  ggplot(aes(index,factor(year)))+
  geom_density_ridges(rel_min_height = 0.03,alpha = 0.4,
                      color = "darkblue",size = 0.4,
                      scale = 1.9,show.legend = F,
                      quantile_lines = T,quantiles = c(0.025,0.5,0.975),
                      linetype = "dashed")+
  labs(x = "营商环境指标",y = "")+
  scale_color_viridis_d()+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(40,40,40,40),
    plot.title = element_text(hjust = 0.5)
  ) +
  facet_wrap(.~location,scales = "free_x")
```

上图展示了三大区域内部营商环境指标的动态分布情况。首先，无论是哪一个区域，代表KDE中心位置的50%分数线不断右移，说明三个地区营商环境是处于逐年优化的状态，这一点和之前关于全国整体层面上KDE曲线中心右移的情况相符。

具体而言，对于东部地区，主波峰由“尖而窄”向“扁而平”转换。同时，波峰的高度持续一定的速度下降，曲线覆盖面积不断扩大。除此之外，整个KDE曲线展现出逐渐由单波峰向两波峰演变的趋势。以上信息说明东部地区内部营商环境指标的绝对差异正不断的扩大，且存在两极分化的趋势。

其次，对于中部地区，波峰的高度以较快的速度下降且覆盖面积随之增加。同时，KDE曲线在样本观测期内便实现了由单波峰向双波峰的转变，且两峰之间的距离不断的拉大。同时，2019年和2018年的右侧拖尾在虽较之于2017年有所左移，但是在整个观测期内还是呈现出明显的右侧拖尾拓宽的规律。这表明中部地区内部各个省市之间营商环境指标的追赶势态十分激烈，且各地的营商环境指标改善速度有较大的差别，从而导致区域内部营商环境指标间差距分化程度的加深。

最后，对于西部地区来说，不同于前两个地区波峰高度逐渐的下降，西部地区KDE曲线的波峰高度是逐年递增的，且主峰的宽度不断缩小。同时，在期末几期出现两个侧峰，且主峰和侧峰的相对距离和侧峰对应的覆盖的面积正不断增加，这说明西部地区营商环境在期末呈现出十分明显的多极分化现象。以上信息表明西部地区各省市营商环境的初始禀赋较为接近，但发展速度却存在明显的分层现象，具体可分为“低”、“中”和“高”三个层次，初始禀赋的近似和后期发展速度的差异导致西部地区的KDE曲线呈现出上图的形状。


## 六、营商环境收敛性分析

上两节分别使用了Dagum基尼系数分解和核密度估计曲线对中国营商环境指标的地区差异特征和动态演进分布进行了研究，本节则在此基础之上，分别使用基于存量视角的$\sigma$收敛模型和基于增量视角的绝对$\beta$收敛模型对营商环境指标的收敛特征展开更进一步的定量实证。


### 1.营商环境$\sigma$收敛分析





```{r echo=FALSE}
# 变异系数法
##########################################################################
load("final_index.rda")

final_index %>%
  mutate(index = (index-min(index))/(max(index)-min(index))) %>% 
  group_by(year,location) %>% 
  summarise(
    sigma = sqrt(mean((index - mean(index))^2))/mean(index)
  ) %>% ungroup() %>% 
  pivot_wider(names_from = location,values_from = sigma)  -> df



final_index %>%
  mutate(index = (index-min(index))/(max(index)-min(index))) %>% 
  group_by(year) %>% 
  summarise(
    全国 = sqrt(mean((index - mean(index))^2))/mean(index)
  ) %>% ungroup() %>% full_join(df,"year") %>% 
  pivot_longer(-1) %>% 
  mutate(
    name = factor(name,levels = c("全国","东部地区","中部地区","西部地区"))
  ) %>% set_names(c("年份","地区","变异系数")) %>% 
  ggplot(aes(年份,变异系数,color = 地区))+
  geom_point(aes(shape = 地区),size =3 )+
  geom_line(size = 1)+
  scale_colour_ggthemr_d()+
  scale_color_viridis_d()+
  scale_x_continuous(n.breaks = 10)+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20),
    legend.position = "bottom"
  )
```

对于全国层面来说，$\sigma$收敛系数经历了一个“下降-增加”的过程，在2010年至2015年的下降期内，减幅为18.85%，年平均减速为1.8%，而在2015年至2018年的上升期内，增幅为5.92%，年平均增速为0.57%，但是在2019年又有所下降。纵观整个考察期，全国的$\sigma$收敛系数呈现出下降趋势且幅度为16.35%，这表明在全国层面上营商环境指标的差异正在不断的减少，也即符合$\sigma$收敛。对于西部地区来说，其$\sigma$收敛系数的演变趋势和全国层面一致，均是在2015年实现了由减到增的趋势转变，只不过西部地区的$\sigma$收敛系数以年平均1.69%的速度进行更快、更明显的下降。对于东部地区来说，其期初2010年与期末2019年的$\sigma$收敛系数相差仅为0.63%，也即变化较为稳定，为出现显著的$\sigma$收敛。对于中部地区而言，其$\sigma$收敛系数虽在2011出现增加，但在2012年至2015年呈现为较为稳定的小幅度减小，在之后年份则呈现出明显的上升趋势。较之于期初，西部地区的期末$\sigma$收敛系数增幅为36.68%，这说明西部地区同样不满足$\sigma$收敛，而且呈现出明显的发散趋势。综上所述，全国层面的整体营商环境指标满足$\sigma$收敛，而具体到三大区域层面则又各不相同。其中，东部地区的$\sigma$收敛系数较为稳定，并未展现出明显的$\sigma$收敛或发散趋势，而中部地区表现出发散特征，西部地区则表现出$\sigma$收敛特征。这一结论和之前区域内基尼系数的分析相符。


### 2.营商环境边际垂直$\beta$收敛分析


1、从经济大背景下：经济新常态

2、从营商环境的相关政策下

3、从统计学角度下：

从14年进行分割可以保持两段的年度跨期比较的均匀，从为尽可能的减少由于样本数量而造成的差异。


#### （1）回归结果分析

```{r echo=FALSE}
load("beta_reg.rda")
beta_reg %>% knitr::kable()
```


上表展示了$\beta$收敛模型的回归结果，并按照考察期的时间跨度分为整个样本考察期、经济新常态之前和经济新常态之后。结合回归方程式（）具体而言，等式右边的$\frac{1}{T}log(\frac{y_{it}}{y_{i0}})$是$T$时段内，营商环境指标的平均对数增长率，而等式右边的解释变量$log(y_{i0})$为$i$地区在期初时营商环境指标的对数值，当其对被解释变量的回归系数为负时，说明两者是反向相关关系的，也即当一个地区营商环境指标的初始禀赋越高，那么其后期发展的速度是越慢的，也即营商环境指标发展是收敛的；而若系数为正则说明发散，也即存在“发达的地方越发发达，落后的地方越发落后”的现象（刘 2018）。



首先对于全国层面来说，其$\alpha$估计系数在任意考察期内均显著为负，且具体数值的变化程度并不大，说明$\beta$收敛机制在全国层面上是稳定存在的。结合$\beta$系数的数值，全国层面的$\beta$收敛系数为0.042，也即说明营商环境指标欠发达的地区以每年4.2%的平均速度向营商环境指标发展较好的地区靠近。从半期收敛系数来看，以目前的收敛速度，要使全国层面的营商环境指标差异缩小为初始差异一半大致需要16年，所以要近一步提高对营商环境的重视程度，尤其是起步较晚的地区。缩小地区差异，实现高质量发展中协调发展的任务刻不容缓。其次，对于三大区域而言，除了中部地区外，东部地区和西部地区均存在统计意义上显著的$\beta$收敛机制。中部地区不存在收敛的结果和前文中其区域间基尼系数不断上升的趋势和KDE的多极分布情况相符合。对于东部地区和西部地区而言，$\beta$系数的绝对值大小依次递减，说明西部地区的收敛速度最大，追赶效应最明显。但是两者的$\beta$系数在两个子考察期内的变化情况截然相反，对此可能的解释是在经济进入新常态后，。。。。（<span style='color:red'>怎么解释！？</span>）尽管如此，在整个考察期内西部地区的收敛速度近似为东部地区的5倍，可能的原因是在丝绸之路经济带的发展的大背景下，依托中央的政策扶持，西部地区有了更多的机会向外部发达地区不断学习和借鉴。同时，随着川渝城市群的一体化建设，西部地区内部各省市之间的联系也更加的紧密，初始禀赋较差的省市利用周边发达省市的“溢出效应”，并结合自身的后发优势从而实现了营商环境的快速发展。





#### （2）边际垂直$\beta$收敛模型

前文基于$\beta$收敛模型的估计系数对全国层面和三大区域层面的收敛情况做出了分析。为能研究不同省市在在全国层面收敛过程中的异质性，本文近一步使用边际垂直$\beta$收敛模型展开研究。图-1至图-2分别展示了2010年至2014年和2015年至2019年的所有省市边际垂直$\beta$系数以及营商环境指标年增长速度。图-1的左侧为营商环境指标年增长速度，虚型线表示均值，上下点型线表示均值加减标准差，散点的大小表示期初营商环境指标指标，越大表明营商环境发展程度越高。图-1的右侧为所有省市边际垂直$\beta$系数大小，其中，上下虚型线表示均值加减标准差，而上下点型线表示均值加减两倍标准差，四条辅助线用来判断省市在收敛过程中的贡献方向和大小，并依次将所有省市划分为“较大正向贡献”、“一般正向贡献”、“无明显贡献”、“一般负向贡献”和“较大负向贡献”5种类型^[为避免极端值的影响，计算均值和标准差时均去掉一个最大点和最小点]。图-2和图-1的结构一样。


```{r echo=FALSE}
# 2010~2014年



load("mvb.rda")
load("ratio_sub1.rda")
load("final_index.rda")
library(patchwork)

## 柱状图

final_index %<>% 
  mutate(index = (index-min(index))/(max(index)-min(index)))

mvb %>% dplyr::filter(period == "2010~2014年") %>% 
  # dplyr::filter(province != "贵州") %>%
  arrange(mar) %>% pull(1) -> lev

mvb %>% dplyr::filter(period == "2010~2014年") %>% 
  arrange(mar) %>% slice(n=2:n()) %>% arrange(-mar) %>% slice(n=2:n()) %>% 
  transmute(
    high_2 = mean(mar)+2*sd(mar),
    high_1 = mean(mar)+1*sd(mar),
    mean = mean(mar),
    low_1 = mean(mar)-sd(mar),
    low_2 = mean(mar)- 2*sd(mar)
  ) %>% slice(n=1) %>% as.double()  -> aux

mvb %>% 
  mutate(
    province = factor(province,levels = lev)
  ) %>% dplyr::filter(period == "2010~2014年") %>% 
  ggplot(aes(province,mar,fill = location))+
  geom_col(position = "dodge")+
  geom_hline(yintercept = aux[[1]],linetype = "dotted",color = "black")+
  geom_hline(yintercept = aux[[2]],linetype = "dashed",color = "black")+
  geom_hline(yintercept = aux[[4]],linetype = "dashed",color = "black")+
  geom_hline(yintercept = aux[[5]],linetype = "dotted",color = "black")+
  scale_colour_ggthemr_d()+
  scale_x_discrete(labels = function(x) str_wrap(x,2))+
  scale_y_continuous(n.breaks = 6)+
  theme(
    text = element_text(family = cnfont),
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5),
    axis.text.x.bottom = element_text(size = 8)
  )+
  scale_fill_manual(values = c(
    alpha("black",0.2),"darkgrey",alpha("black",0.6)
  ))+
  labs(x = "",y = "",fill = "地区") -> sub1_1


## 散点图

ratio_sub1 %>% 
  arrange(ratio) %>% slice(n=2:n()) %>% arrange(-ratio) %>% slice(n=2:n()) %>%
  transmute(
    mean = mean(ratio),
    sd = sd(ratio),
    low = mean-sd,
    high = mean+sd
  ) %>% slice(n=1) %>% as.double() %>% .[-2] -> aux

ratio_sub1 %>% 
  arrange(ratio) %>% 
  mutate(province = fct_inorder(province)) %>% 
  mutate(
    index = case_when(
      index<=0.2 ~"low",
      (index>0.2)&(index <= 0.4) ~"mid",
      (index>0.4)&(index<=0.6) ~"high",
      index>0.6 ~"extra"
    ),
    index = factor(
      index,
      levels = c("low","mid","high","extra")
    )
  ) %>% 
  ggplot()+
  geom_point(
    aes(province,ratio,size = index),
    show.legend = F,color = "darkgrey")+
  scale_size_manual(values = c(2.5,3.5,3.5,4.1))+
  geom_hline(yintercept = aux[[1]],color = "black",linetype = "dashed")+
  geom_hline(yintercept = aux[[2]],color = "black",linetype = "dotted")+
  geom_hline(yintercept = aux[[3]],color = "black",linetype = "dotted")+
  theme(
    text = element_text(family = cnfont),
    axis.text.x.bottom = element_text(size = 7.5),
    axis.title.y.left = element_text(angle = 0)
  )+
  scale_x_discrete(labels = function(x) str_wrap(x,2))+
  scale_y_continuous(labels = function(x) percent(x))+
  labs(x="",y=str_wrap("年平均增长率",2)) -> sub1_2


## 合并两者


(sub1_2+sub1_1)+
  plot_layout(guides = 'collect')&theme(legend.position = "bottom") 

```

对于图-1的右侧，在第一个子考察期内，东部地区省市对整体收敛的贡献多是负向的，其中广东和山东属于负向贡献的第一梯度、其次是海南。而对收敛过程起到明显正向贡献的为河北。中部地区的8个省市均未对收敛过程起到明显的贡献作用；西部地区对收敛过程呈现明显负向贡献的依次为新疆和宁夏，而起到正向贡献的为甘肃和贵州。同时，结合广东和山东营商环境指标的年平均增长率和初始营商环境指标可知，对于广东和山东为代表的东部沿海省市，其经济体量较大、经济发展程度较好，企业的数量和活跃度都较高，营商环境指标的发展也较为成熟。并且，广东和山东的增长速度分别为第一、第二，本身就较发达的地区以最快的速度发展，相当于提高了差异的上限，因此这些省份导致了差距的拉大，即在收敛过程中起到了发散的作用。而对于海南和宁夏两省，其年平均速度近似于平均增长速度减去一倍标准差，故可认为其发展速度较低。对于这样初始禀赋较差的地区，当其增长速度还要低于平均速度时，就相当于拉低了差异的下限，因此也导致了发散。对于收敛过程起正向贡献的贵州、甘肃和河北三省来说，前两个西部省份的初始营商环境发展程度较低，但是其发展速度较快，接近于平均速度加上一倍标准差，也即欠发达地区以一个较快的速度向发达地区进行追赶，上一期的差异由于这种发展速度差会在下一期会缩小，因此会出现收敛的现象。对于河北来说，其发展速度略小于平均增长速度，但初始营商环境发展程度较高，相当于处于初始差异上限的个体以一个较低的速度发展，差异的上限在不断降低，因此导致了整体上的收敛。总体来说，在经济进入新常态之前，东部沿海地区营商环境的发展速度较快，但是西部地区的追赶效应也较为明显，也即差异上下限的发展速度都较快，反而是以中部地区为代表的省市发展速度较低，对整体的收敛过程未起到明显的贡献。这一结论和之前区域间基尼系数的分析相符。


```{r echo=FALSE}
# 2015~2019年



load("mvb.rda")
load("final_index.rda")
load("ratio_sub2.rda")
library(patchwork)

## 柱状图

final_index %<>% 
  mutate(index = (index-min(index))/(max(index)-min(index)))

mvb %>% dplyr::filter(period == "2015~2019年") %>% 
  #dplyr::filter(province != "贵州") %>% 
  arrange(mar) %>% pull(1) -> lev

mvb %>% dplyr::filter(period == "2015~2019年") %>% 
  arrange(mar) %>% slice(n=2:n()) %>% arrange(-mar) %>% slice(n=2:n()) %>%
  dplyr::filter(province != "贵州") %>% 
  transmute(
    high_2 = mean(mar)+2*sd(mar),
    high_1 = mean(mar)+1*sd(mar),
    mean = mean(mar),
    low_1 = mean(mar)-sd(mar),
    low_2 = mean(mar)- 2*sd(mar)
  ) %>% slice(n=1) %>% as.double()  -> aux

mvb %>% 
  mutate(
    province = factor(province,levels = lev)
  ) %>% dplyr::filter(period == "2015~2019年") %>% 
  ggplot(aes(province,mar,fill = location))+
  geom_col(position = "dodge")+
  geom_hline(yintercept = aux[[1]],linetype = "dotted",color = "black")+
  geom_hline(yintercept = aux[[2]],linetype = "dashed",color = "black")+
  geom_hline(yintercept = aux[[4]],linetype = "dashed",color = "black")+
  geom_hline(yintercept = aux[[5]],linetype = "dotted",color = "black")+
  scale_colour_ggthemr_d()+
  scale_x_discrete(labels = function(x) str_wrap(x,2))+
  scale_y_continuous(n.breaks = 5)+
  theme(
    text = element_text(family = cnfont),
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5),
    axis.text.x.bottom = element_text(size = 8)
  )+
  scale_fill_manual(values = c(
    alpha("black",0.2),"darkgrey",alpha("black",0.6)
  ))+
  labs(x = "",y = "",fill = "地区") -> sub2_1


## 散点图 

ratio_sub2 %>%   
  arrange(ratio) %>% slice(n=2:n()) %>% arrange(-ratio) %>% slice(n=2:n()) %>%
  transmute(
    mean = mean(ratio),
    sd = sd(ratio),
    low = mean-sd,
    high = mean+sd
  ) %>% slice(n=1) %>% as.double() %>% .[-2] -> aux

ratio_sub2 %>% 
  arrange(ratio) %>% 
  mutate(province = fct_inorder(province)) %>% 
  # dplyr::filter(province == "广东")
  mutate(
    index = case_when(
      index<=0.2 ~"low",
      (index>0.2)&(index <= 0.4) ~"mid",
      (index>0.4)&(index<=0.6) ~"high",
      index>0.6 ~"extra"
    ),
    index = factor(
      index,
      levels = c("low","mid","high","extra")
    )
  ) %>% 
  ggplot()+
  geom_point(
    aes(province,ratio,size = index),
    show.legend = F,color = "darkgrey")+
  scale_size_manual(values = c(2,2.5,3.5,4.1))+
  geom_hline(yintercept = aux[[1]],color = "black",linetype = "dashed")+
  geom_hline(yintercept = aux[[2]],color = "black",linetype = "dotted")+
  geom_hline(yintercept = aux[[3]],color = "black",linetype = "dotted")+
  theme(
    text = element_text(family = cnfont),
    axis.text.x.bottom = element_text(size = 7.5),
    axis.title.y.left = element_text(angle = 0)
  )+
  scale_x_discrete(labels = function(x) str_wrap(x,2))+
  scale_y_continuous(labels = function(x) percent(x))+
  labs(x="",y=str_wrap("年平均增长率",2)) -> sub2_2


(sub2_2+sub2_1)+
  plot_layout(guides = 'collect')&theme(legend.position = "bottom") 


```




## 七、营商环境空间集聚特征分析

Moran’s I指数可看作省市营商环境指标的乘积和，并在-1~1内波动。如果Moran’s I指数大于 0，则说明营商环境指标在空间集聚上存在着正自相关， 即临近区域间的营商环境指标具有相似属性， 营商环境良好的省市更倾向于集聚在一起，而营商环境指标较低的省市和同样较低的省市集聚。在其数值为正数情况下，越大的Moran’s I指数意味着空间分布上的正自相关性越强， 集聚的强度也越大；若其数值小于 0， 则说明存在空间分布上的负自相关，营商环境发展水平高的省市和营商环境发展水平低的省市更易集聚在一起。同时，越小的数值表明各空间单位的离散程度越大；若其数值为0， 则说明营商环境指标的空间分布是近似随机的，省市间不存在明显空间相关性。

```{r echo=FALSE}
load("moranSC.rda")

moranSC %>% mutate(year = 2010:2019) %>% relocate(3) %>% 
  set_names(c("年份","Moran’s I指数","p值")) %>% 
  ggplot()+
  geom_point(aes(年份,`Moran’s I指数`),size = 3)+
  geom_line(size = 1,aes(年份,`Moran’s I指数`),color = alpha("red",0.5))+
  geom_text(aes(label = round(`Moran’s I指数`,3),x =年份,y = `Moran’s I指数`),
            nudge_x = 0.05,family=cnfont,
            nudge_y = 0.009,color = alpha("red")
            )+
  geom_col(aes(年份,p值),fill = alpha("orange",0.5))+
  scale_x_continuous(n.breaks = 10)+
  labs(y="",x="年份")+
  geom_hline(yintercept = 0.1,linetype = "dashed")+
  geom_hline(yintercept = 0.05,linetype = "dashed")+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(20,20,20,20),
    legend.position = "bottom"
  )
```

上图中的折线图反映了Moran’s I指数随年份变化的趋势，下方的柱状图表示相应年份，Moran’s I指数对应的P值。首先，可以发现，在10年的考察期内，有4年的Moran’s I指数是在5%的显著性水平上显著，而剩下的6年则至少是在10%的显著性水平上显著，在统计上说明了Moran’s I指数是有说服力的。其次，在考察期内，所有的Moran’s I指数均大于0，且最高点0.183在2012年取得，最低点0.122在期末2019年取得。这说明在中国整体层面上，Moran’s I指数的正空间集聚性是一直存在的。最后，Moran’s I指数虽在2012年和2016年有过短暂的上升，但是从整体上来说则是呈现出下降的态势，这一点和之前收敛机制分析的结果具有一致性，说明在整体层面上营商环境指标在空间上的全局相关性在逐渐降低。

虽然全域Moran’s I指数可以描绘营商环境指标在整体上的空间自相关性，但为近一步研究地区间的空间集聚性，本文采取局域Moran’s I指数分析。在局域Moran’s I指数分析中，一般是通过图形来展示不同地区的空间关系模式。 具体而言， 通过在二维平面上绘制局域Moran’s I指数散点图，将各省市的营商环境指标分为4个象限的集群模式。具体而言，第一象限为“高-高”组合，表示营商环境指标高的省市被同是高营商环境指标的省市集聚；第二象限为“低-高”组合，表示营商环境指标较低的省市被高指标省市包围；第三象限为“低-低”组合，表示营商环境指标水平低的省市被同为较低指标的省市包围；第四象限为“高-低”组合，表示营商环境指标高的省市被低指标的省市包围，其中一、三象限表示正空间自相关，二四象限表示负空间自相关。为使结论具有说法力，本文分别选取代表期初的2010年、代表期中的2016年和代表期末的2019年对应的Moran’s I指数散点图进行说明。

```{r echo=FALSE}
library(ggrepel)
load("moran.rda")
moran %>%
  dplyr::filter(year %in% c(2010,2016,2019)) %>%
  mutate(face = paste(year,"年Moran’s I指数")) %>%
  mutate(
    LABEL = if_else(
      (year == 2019&location == "西部地区")&(std_index>0|w_std_index>0),
      province,""
    )
  ) %>%
  ggplot(aes(std_index,w_std_index,label = LABEL))+
  geom_smooth(method = "lm",se = F,linetype = "solid",color = "cyan")+
  scale_colour_ggthemr_d()+
  geom_point(size = 1.5,aes(color = location))+
  # geom_label_repel(box.padding = 4.5,label.padding = 0.2,
  #                  max.overlaps = Inf,
  #                  family = cnfont,min.segment.length = 0.001,
  #                  size = 3.5
  #                  )+
  scale_color_viridis_d()+
  # scale_color_manual(values = c("black","red","blue"))+
  labs(x="",y="",color = "地区")+
  geom_abline(intercept = 0, slope = 0,linetype = "dotted")+
  geom_vline(xintercept = 0,linetype = "dotted")+
  facet_grid(.~face)+
  theme(
    text = element_text(family = cnfont),
    plot.margin = margin(40,40,40,40),
    plot.title = element_text(hjust = 0.5),
    legend.position = "bottom"
  )


```

从上图中不难发现，三条线性拟合线均是正斜率，这一点和全局Moran’s I指数恒为正向符合。其次，近似75%的散点都处于第一象限或第三象限内，这说明营商环境指标在绝大多数省市内存在“高-高”或“低-低”的空间集聚特征。近一步，根据散点的颜色可知，第三象限中的散点近乎全是西部地区，而处以第一象限中的散点则完全由中部和东部地区组成。这说明西部地区省市及其临近省市的营商环境指标也同样较低，而东部省市及其临近省市的营商环境指标都比较高，说明地域上的梯度效应十分明显。最后，基于下表中信息和纵向对比不同年份的散点图可以发现，虽然整体上四个象限中散点分布的数量未有明显的变化，但在2019年已有四个西部的省市离开第三象限，而转移到了二、四象限，并且在三个代表期内线性拟合线的斜率依次降低，说明营商环境指标的空间辐射作用呈下降趋势，且存在着空间异质性。


```{r echo=FALSE}
load("moran.rda")

map_dbl(
  2010:2019,
  ~ lm(w_std_index~std_index,data = dplyr::filter(moran ,year == .x)) %>% 
    coef() %>% .[[2]]
) %>% round(3)-> coefff


moran %>% group_by(year) %>% 
  set_names(c("province","年份","location","x","y")) %>% 
  mutate(
    象限 = case_when(
      x >= 0 & y >= 0 ~"第一象限",
      x <= 0 & y >= 0 ~"第二象限",
      x <= 0 & y <= 0 ~"第三象限",
      x >= 0 & y <= 0 ~"第四象限"
    )
  ) %>% group_by(年份,象限) %>% 
  summarise(
    n = n()
  ) %>% ungroup() %>% pivot_wider(names_from = "象限",values_from = n) %>% 
  relocate(1,5) %>% bind_cols(coefff) %>% 
  rename( "线性拟合线斜率" = `...6`) %>% knitr::kable()
```


## 八、结论与政策建议





